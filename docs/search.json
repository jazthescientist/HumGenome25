[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Connecting Github",
    "section": "",
    "text": "knitr::include_graphics(\"LOGO.png\")\n\n\n\n\n\n\n\n\n\n\n\nView Lab 7\n\nfile.create(\"docs/.nojekyll\")\n\n[1] TRUE"
  },
  {
    "objectID": "index.html#about-me",
    "href": "index.html#about-me",
    "title": "Connecting Github",
    "section": "",
    "text": "knitr::include_graphics(\"LOGO.png\")\n\n\n\n\n\n\n\n\n\n\n\nView Lab 7\n\nfile.create(\"docs/.nojekyll\")\n\n[1] TRUE"
  },
  {
    "objectID": "Lab7.html",
    "href": "Lab7.html",
    "title": "Lab 7",
    "section": "",
    "text": "library(tidyverse)\nlibrary(lubridate)\n\n# set a writable path (your home directory)\nfile_path &lt;- \"~/time_series_covid19_confirmed_global.csv\"\n\n# download file\ndownload.file(\n  url = \"https://raw.githubusercontent.com/CSSEGISandData/COVID-19/master/csse_covid_19_data/csse_covid_19_time_series/time_series_covid19_confirmed_global.csv\",\n  destfile = file_path,\n  mode = \"wb\"\n)\n\n# read and rename columns\ntime_series_confirmed &lt;- read_csv(file_path) |&gt;\n  rename(\n    Province_State = `Province/State`,\n    Country_Region = `Country/Region`\n  )\n\n\n# file already downloaded here:\nfile_path &lt;- \"~/time_series_covid19_confirmed_global.csv\"\n\n# try saving a copy into the lab folder (only if permitted)\ntarget_path &lt;- \"/work/pi_jlb_umass_edu/blanchardlab/RNA_phages/time_series_covid19_confirmed_global.csv\"\n\n# check if you can write to the folder\ncan_write &lt;- file.access(dirname(target_path), 2) == 0\n\nif (can_write) {\n  file.copy(from = file_path, to = target_path, overwrite = TRUE)\n  message(\"Saved to RNA_phages folder.\")\n} else {\n  message(\"No permission to save to RNA_phages. Keeping it in home directory.\")\n}\n\n# load from whichever path exists\nif (file.exists(target_path)) {\n  covid_path &lt;- target_path\n} else {\n  covid_path &lt;- file_path\n}\n\ntime_series_confirmed &lt;- read_csv(covid_path) |&gt;\n  rename(\n    Province_State = `Province/State`,\n    Country_Region = `Country/Region`\n  )\n\n\n\ncolnames(time_series_confirmed)[1:10]   # first columns\n\n [1] \"Province_State\" \"Country_Region\" \"Lat\"            \"Long\"          \n [5] \"1/22/20\"        \"1/23/20\"        \"1/24/20\"        \"1/25/20\"       \n [9] \"1/26/20\"        \"1/27/20\"       \n\ntail(colnames(time_series_confirmed))   # last columns (should be dates)\n\n[1] \"3/4/23\" \"3/5/23\" \"3/6/23\" \"3/7/23\" \"3/8/23\" \"3/9/23\"\n\ntime_series_confirmed_long &lt;- time_series_confirmed |&gt;\n  pivot_longer(\n    cols = -(Province_State:Long),    # all date columns\n    names_to = \"Date\",\n    values_to = \"Confirmed\"\n  )\n\n\n\ntime_series_confirmed_long &lt;- time_series_confirmed_long |&gt;\n  mutate(Date = mdy(Date))\n\ntime_series_confirmed_long |&gt;\n  group_by(Country_Region, Date) |&gt;\n  summarise(Confirmed = sum(Confirmed), .groups = \"drop\") |&gt;\n  filter(Country_Region == \"US\") |&gt;\n  ggplot(aes(x = Date, y = Confirmed)) +\n  geom_line() +\n  geom_point() +\n  ggtitle(\"US COVID-19 Confirmed Cases Over Time\")\n\n\n\n\n\n\n\n\n\n\n\n\ntime_series_confirmed_long |&gt; \n    group_by(Country_Region, Date) |&gt; \n    summarise(Confirmed = sum(Confirmed)) |&gt; \n    filter (Country_Region %in% c(\"China\",\"France\",\"Italy\", \n                                \"Korea, South\", \"US\")) |&gt; \n    ggplot(aes(x = Date,  y = Confirmed, color = Country_Region)) + \n      geom_point() +\n      geom_line() +\n      ggtitle(\"COVID-19 Confirmed Cases\")\n\n\n\n\n\n\n\n\n\n\n\n\ntime_series_confirmed_long_daily &lt;-time_series_confirmed_long |&gt; \n    group_by(Country_Region, Date) |&gt; \n    summarise(Confirmed = sum(Confirmed)) |&gt; \n    mutate(Daily = Confirmed - lag(Confirmed, default = first(Confirmed )))\n\ntime_series_confirmed_long_daily |&gt; \n    filter (Country_Region == \"US\") |&gt; \n    ggplot(aes(x = Date,  y = Daily, color = Country_Region)) + \n      geom_point() +\n      ggtitle(\"COVID-19 Confirmed Cases\")\n\n\n\n\n\n\n\n\n\n\n\n\ntime_series_confirmed_long_daily |&gt; \n    filter (Country_Region == \"US\") |&gt; \n    ggplot(aes(x = Date,  y = Daily, color = Country_Region)) + \n      geom_line() +\n      ggtitle(\"COVID-19 Confirmed Cases\")\n\n\n\n\n\n\n\n\n\n\n\n\ntime_series_confirmed_long_daily |&gt; \n    filter (Country_Region == \"US\") |&gt; \n    ggplot(aes(x = Date,  y = Daily, color = Country_Region)) + \n      geom_smooth() +\n      ggtitle(\"COVID-19 Confirmed Cases\")\n\n\n\n\n\n\n\n\n\n\n\n\ntime_series_confirmed_long_daily |&gt; \n    filter (Country_Region == \"US\") |&gt; \n    ggplot(aes(x = Date,  y = Daily, color = Country_Region)) + \n      geom_smooth(method = \"gam\", se = FALSE) +\n      ggtitle(\"COVID-19 Confirmed Cases\")\n\n\n\n\n\n\n\n\n\n\n\n\nlibrary(gganimate)\nlibrary(gifski)\ntheme_set(theme_bw())\n\n\ndaily_counts &lt;- time_series_confirmed_long_daily |&gt; \n      filter (Country_Region == \"US\")\n\np &lt;- ggplot(daily_counts, aes(x = Date,  y = Daily, color = Country_Region)) + \n        geom_point() +\n        ggtitle(\"Confirmed COVID-19 Cases\") +\n# gganimate lines  \n        geom_point(aes(group = seq_along(Date))) +\n        transition_reveal(Date) \n\n# make the animation\n animate(p, renderer = gifski_renderer(), end_pause = 15)\n\n\n\n\n\n\n\n anim_save(\"daily_counts_US.gif\", p)\n\n\n\n\n\n# Compute rate per 10,000\ntable1 |&gt;\n  mutate(rate = cases / population * 10000)\n\n# A tibble: 6 × 5\n  country      year  cases population  rate\n  &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;\n1 Afghanistan  1999    745   19987071 0.373\n2 Afghanistan  2000   2666   20595360 1.29 \n3 Brazil       1999  37737  172006362 2.19 \n4 Brazil       2000  80488  174504898 4.61 \n5 China        1999 212258 1272915272 1.67 \n6 China        2000 213766 1280428583 1.67 \n\n#&gt; # A tibble: 6 × 5\n#&gt;   country      year  cases population  rate\n#&gt;   &lt;chr&gt;       &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt;\n#&gt; 1 Afghanistan  1999    745   19987071 0.373\n#&gt; 2 Afghanistan  2000   2666   20595360 1.29 \n#&gt; 3 Brazil       1999  37737  172006362 2.19 \n#&gt; 4 Brazil       2000  80488  174504898 4.61 \n#&gt; 5 China        1999 212258 1272915272 1.67 \n#&gt; 6 China        2000 213766 1280428583 1.67\n\n# Compute total cases per year\ntable1 |&gt; \n  group_by(year) |&gt; \n  summarize(total_cases = sum(cases))\n\n# A tibble: 2 × 2\n   year total_cases\n  &lt;dbl&gt;       &lt;dbl&gt;\n1  1999      250740\n2  2000      296920\n\n#&gt; # A tibble: 2 × 2\n#&gt;    year total_cases\n#&gt;   &lt;dbl&gt;       &lt;dbl&gt;\n#&gt; 1  1999      250740\n#&gt; 2  2000      296920\n\n# Visualize changes over time\nggplot(table1, aes(x = year, y = cases)) +\n  geom_line(aes(group = country), color = \"grey50\") +\n  geom_point(aes(color = country, shape = country)) +\n  scale_x_continuous(breaks = c(1999, 2000)) # x-axis breaks at 1999 and 2000\n\n\n\n\n\n\n\n\n\n\n\n\n\nEach row shows a country in a specific year, and each column shows its TB cases, population, and calculated rate.\n\n\n\n\ntable2_rate &lt;- table2 |&gt;\n  pivot_wider(names_from = type, values_from = count) |&gt;\n  mutate(rate = cases / population * 10000)\n\ntable3_rate &lt;- table3 |&gt;\n  separate(rate, into = c(\"cases\", \"population\"), sep = \"/\") |&gt;\n  mutate(cases = as.numeric(cases),\n         population = as.numeric(population),\n         rate = cases / population * 10000)\n\nggplot(table1, aes(x = year, y = cases)) +\n  geom_line(aes(group = country), color = \"grey60\") +\n  geom_point(aes(color = country)) +\n  facet_wrap(~ country, scales = \"free_y\")\n\n\n\n\n\n\n\n\n\n\n\n\ncountries &lt;- c(\"US\", \"India\", \"Brazil\", \"China\", \"Italy\")\n\ndaily_cases &lt;- time_series_confirmed_long |&gt;\n  group_by(Country_Region, Date) |&gt;\n  summarise(Confirmed = sum(Confirmed), .groups = \"drop\") |&gt;\n  group_by(Country_Region) |&gt;\n  arrange(Date) |&gt;\n  mutate(Daily = Confirmed - lag(Confirmed)) |&gt;\n  filter(Country_Region %in% countries)\n\nggplot(daily_cases, aes(x = Date, y = Daily, color = Country_Region)) +\n  geom_line() +\n  labs(title = \"Daily COVID-19 Confirmed Cases\",\n       x = \"Date\", y = \"Daily Cases\")"
  },
  {
    "objectID": "Lab7.html#exercises-5.2.1",
    "href": "Lab7.html#exercises-5.2.1",
    "title": "Lab 7",
    "section": "",
    "text": "Each row shows a country in a specific year, and each column shows its TB cases, population, and calculated rate.\n\n\n\n\ntable2_rate &lt;- table2 |&gt;\n  pivot_wider(names_from = type, values_from = count) |&gt;\n  mutate(rate = cases / population * 10000)\n\ntable3_rate &lt;- table3 |&gt;\n  separate(rate, into = c(\"cases\", \"population\"), sep = \"/\") |&gt;\n  mutate(cases = as.numeric(cases),\n         population = as.numeric(population),\n         rate = cases / population * 10000)\n\nggplot(table1, aes(x = year, y = cases)) +\n  geom_line(aes(group = country), color = \"grey60\") +\n  geom_point(aes(color = country)) +\n  facet_wrap(~ country, scales = \"free_y\")\n\n\n\n\n\n\n\n\n\n\n\n\ncountries &lt;- c(\"US\", \"India\", \"Brazil\", \"China\", \"Italy\")\n\ndaily_cases &lt;- time_series_confirmed_long |&gt;\n  group_by(Country_Region, Date) |&gt;\n  summarise(Confirmed = sum(Confirmed), .groups = \"drop\") |&gt;\n  group_by(Country_Region) |&gt;\n  arrange(Date) |&gt;\n  mutate(Daily = Confirmed - lag(Confirmed)) |&gt;\n  filter(Country_Region %in% countries)\n\nggplot(daily_cases, aes(x = Date, y = Daily, color = Country_Region)) +\n  geom_line() +\n  labs(title = \"Daily COVID-19 Confirmed Cases\",\n       x = \"Date\", y = \"Daily Cases\")"
  }
]